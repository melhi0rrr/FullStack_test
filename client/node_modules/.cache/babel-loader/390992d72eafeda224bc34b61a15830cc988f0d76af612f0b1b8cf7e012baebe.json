{"ast":null,"code":"var _jsxFileName = \"D:\\\\Progects\\\\task_server\\\\FullStack_test\\\\client\\\\src\\\\context\\\\UserContext.jsx\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport React, { createContext, useContext, useEffect, useReducer } from 'react';\nimport * as api from '../services/api';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst UserContext = /*#__PURE__*/createContext();\nconst initialState = {\n  users: [],\n  currentPage: 1,\n  totalPages: 1,\n  loading: true,\n  error: null\n};\nfunction reducer(state, action) {\n  switch (action.type) {\n    case 'FETCH_START':\n      return {\n        ...state,\n        loading: true,\n        error: null\n      };\n    case 'FETCH_SUCCESS':\n      return {\n        ...state,\n        loading: false,\n        users: action.payload.users,\n        totalPages: action.payload.totalPages,\n        currentPage: action.payload.currentPage\n      };\n    case 'FETCH_ERROR':\n      return {\n        ...state,\n        loading: false,\n        error: action.payload\n      };\n    case 'ADD_USER':\n      return {\n        ...state,\n        users: [action.payload, ...state.users]\n      };\n    case 'UPDATE_USER':\n      return {\n        ...state,\n        users: state.users.map(user => user.id === action.payload.id ? action.payload : user)\n      };\n    case 'DELETE_USER':\n      return {\n        ...state,\n        users: state.users.filter(user => user.id !== action.payload)\n      };\n    case 'SET_PAGE':\n      return {\n        ...state,\n        currentPage: action.payload\n      };\n    default:\n      return state;\n  }\n}\nexport function UserProvider({\n  children\n}) {\n  _s();\n  const [state, dispatch] = useReducer(reducer, initialState);\n  const fetchUsers = async (page = 1, limit = 10) => {\n    try {\n      dispatch({\n        type: 'FETCH_START'\n      });\n      const response = await api.getUsers(page, limit);\n\n      // Проверка структуры ответа\n      const responseData = response.data;\n\n      // Если ответ не содержит ожидаемых полей\n      if (!responseData.data || !responseData.totalPages) {\n        throw new Error('Некорректный формат ответа сервера');\n      }\n      dispatch({\n        type: 'FETCH_SUCCESS',\n        payload: {\n          users: responseData.data,\n          totalPages: responseData.totalPages,\n          currentPage: page\n        }\n      });\n    } catch (error) {\n      console.error('Ошибка загрузки пользователей:', error);\n      dispatch({\n        type: 'FETCH_ERROR',\n        payload: error.message || 'Ошибка загрузки данных'\n      });\n    }\n  };\n  const addUser = async user => {\n    try {\n      const response = await api.createUser(user);\n      const newUser = response.data;\n      dispatch({\n        type: 'ADD_USER',\n        payload: newUser\n      });\n      return newUser;\n    } catch (error) {\n      console.error('Ошибка создания пользователя:', error);\n      throw error;\n    }\n  };\n  const updateUser = async (id, user) => {\n    try {\n      const response = await api.updateUser(id, user);\n      const updatedUser = response.data;\n      dispatch({\n        type: 'UPDATE_USER',\n        payload: updatedUser\n      });\n      return updatedUser;\n    } catch (error) {\n      console.error('Ошибка обновления пользователя:', error);\n      throw error;\n    }\n  };\n  const deleteUser = async id => {\n    try {\n      await api.deleteUser(id);\n      dispatch({\n        type: 'DELETE_USER',\n        payload: id\n      });\n    } catch (error) {\n      console.error('Ошибка удаления пользователя:', error);\n      throw error;\n    }\n  };\n  const setPage = page => {\n    dispatch({\n      type: 'SET_PAGE',\n      payload: page\n    });\n    fetchUsers(page);\n  };\n  useEffect(() => {\n    fetchUsers();\n  }, []);\n  return /*#__PURE__*/_jsxDEV(UserContext.Provider, {\n    value: {\n      ...state,\n      fetchUsers,\n      addUser,\n      updateUser,\n      deleteUser,\n      setPage\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 128,\n    columnNumber: 5\n  }, this);\n}\n_s(UserProvider, \"bgCdjuTOmPdSBRwTap80EFd9Y3U=\");\n_c = UserProvider;\nexport const useUserContext = () => {\n  _s2();\n  return useContext(UserContext);\n};\n_s2(useUserContext, \"gDsCjeeItUuvgOWf1v4qoK9RF6k=\");\nvar _c;\n$RefreshReg$(_c, \"UserProvider\");","map":{"version":3,"names":["React","createContext","useContext","useEffect","useReducer","api","jsxDEV","_jsxDEV","UserContext","initialState","users","currentPage","totalPages","loading","error","reducer","state","action","type","payload","map","user","id","filter","UserProvider","children","_s","dispatch","fetchUsers","page","limit","response","getUsers","responseData","data","Error","console","message","addUser","createUser","newUser","updateUser","updatedUser","deleteUser","setPage","Provider","value","fileName","_jsxFileName","lineNumber","columnNumber","_c","useUserContext","_s2","$RefreshReg$"],"sources":["D:/Progects/task_server/FullStack_test/client/src/context/UserContext.jsx"],"sourcesContent":["import React, { createContext, useContext, useEffect, useReducer } from 'react';\r\nimport * as api from '../services/api';\r\n\r\nconst UserContext = createContext();\r\n\r\nconst initialState = {\r\n  users: [],\r\n  currentPage: 1,\r\n  totalPages: 1,\r\n  loading: true,\r\n  error: null,\r\n};\r\n\r\nfunction reducer(state, action) {\r\n  switch (action.type) {\r\n    case 'FETCH_START':\r\n      return { ...state, loading: true, error: null };\r\n    case 'FETCH_SUCCESS':\r\n      return {\r\n        ...state,\r\n        loading: false,\r\n        users: action.payload.users,\r\n        totalPages: action.payload.totalPages,\r\n        currentPage: action.payload.currentPage,\r\n      };\r\n    case 'FETCH_ERROR':\r\n      return { ...state, loading: false, error: action.payload };\r\n    case 'ADD_USER':\r\n      return { ...state, users: [action.payload, ...state.users] };\r\n    case 'UPDATE_USER':\r\n      return {\r\n        ...state,\r\n        users: state.users.map(user => \r\n          user.id === action.payload.id ? action.payload : user\r\n        ),\r\n      };\r\n    case 'DELETE_USER':\r\n      return {\r\n        ...state,\r\n        users: state.users.filter(user => user.id !== action.payload),\r\n      };\r\n    case 'SET_PAGE':\r\n      return { ...state, currentPage: action.payload };\r\n    default:\r\n      return state;\r\n  }\r\n}\r\n\r\nexport function UserProvider({ children }) {\r\n  const [state, dispatch] = useReducer(reducer, initialState);\r\n\r\n  const fetchUsers = async (page = 1, limit = 10) => {\r\n    try {\r\n      dispatch({ type: 'FETCH_START' });\r\n      const response = await api.getUsers(page, limit);\r\n      \r\n      // Проверка структуры ответа\r\n      const responseData = response.data;\r\n      \r\n      // Если ответ не содержит ожидаемых полей\r\n      if (!responseData.data || !responseData.totalPages) {\r\n        throw new Error('Некорректный формат ответа сервера');\r\n      }\r\n      \r\n      dispatch({\r\n        type: 'FETCH_SUCCESS',\r\n        payload: {\r\n          users: responseData.data,\r\n          totalPages: responseData.totalPages,\r\n          currentPage: page,\r\n        },\r\n      });\r\n    } catch (error) {\r\n      console.error('Ошибка загрузки пользователей:', error);\r\n      dispatch({ \r\n        type: 'FETCH_ERROR', \r\n        payload: error.message || 'Ошибка загрузки данных'\r\n      });\r\n    }\r\n  };\r\n\r\n  const addUser = async user => {\r\n    try {\r\n      const response = await api.createUser(user);\r\n      const newUser = response.data;\r\n      \r\n      dispatch({ type: 'ADD_USER', payload: newUser });\r\n      return newUser;\r\n    } catch (error) {\r\n      console.error('Ошибка создания пользователя:', error);\r\n      throw error;\r\n    }\r\n  };\r\n\r\n  const updateUser = async (id, user) => {\r\n    try {\r\n      const response = await api.updateUser(id, user);\r\n      const updatedUser = response.data;\r\n      \r\n      dispatch({ type: 'UPDATE_USER', payload: updatedUser });\r\n      return updatedUser;\r\n    } catch (error) {\r\n      console.error('Ошибка обновления пользователя:', error);\r\n      throw error;\r\n    }\r\n  };\r\n\r\n  const deleteUser = async id => {\r\n    try {\r\n      await api.deleteUser(id);\r\n      dispatch({ type: 'DELETE_USER', payload: id });\r\n    } catch (error) {\r\n      console.error('Ошибка удаления пользователя:', error);\r\n      throw error;\r\n    }\r\n  };\r\n\r\n  const setPage = page => {\r\n    dispatch({ type: 'SET_PAGE', payload: page });\r\n    fetchUsers(page);\r\n  };\r\n\r\n  useEffect(() => {\r\n    fetchUsers();\r\n  }, []);\r\n\r\n  return (\r\n    <UserContext.Provider\r\n      value={{\r\n        ...state,\r\n        fetchUsers,\r\n        addUser,\r\n        updateUser,\r\n        deleteUser,\r\n        setPage,\r\n      }}\r\n    >\r\n      {children}\r\n    </UserContext.Provider>\r\n  );\r\n}\r\n\r\nexport const useUserContext = () => useContext(UserContext);"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}